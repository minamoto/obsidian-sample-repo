<?xml version="1.0" encoding="UTF-8"?>
<?asciidoc-toc maxdepth="2"?>
<?asciidoc-numbered?>
<book xmlns="http://docbook.org/ns/docbook" xmlns:xl="http://www.w3.org/1999/xlink" version="5.0" xml:lang="ja">
<info>
<title>学習環境としてOpenShift Localをインストールする</title>
<date>2024-11-16</date>
<author>
<personname>
<firstname>Fusayuki</firstname>
<surname>Minamoto</surname>
</personname>
</author>
<authorinitials>FM</authorinitials>
<revhistory>
<revision>
<revnumber>1.0</revnumber>
<date>2024-11-16</date>
<authorinitials>FM</authorinitials>
</revision>
</revhistory>
</info>
<chapter xml:id="_はじめに">
<title>はじめに</title>
<simpara>OpenShiftの学習者向けに、OpenShift Localのインストール手順と基本的なツールの使い方を説明します。OpenShift Localは開発者向けの環境ではありますが、kubeadminというアカウントでログインをすることで管理者権限が必要なコマンドも操作できることを示します。</simpara>
</chapter>
<chapter xml:id="_openshift_localとは">
<title>OpenShift Localとは</title>
<simpara>Red Hat OpenShift Localは、無償で使うことができるシングルノードのOpenShiftです。開発者がデスクトップにインストールして開発やテスト用途に使うことが想定されています。この記事では、OpenShift Local 2.43を使ってOpenShiftをインストールします。詳細は以下のドキュメントを参照してください。</simpara>
<simpara><link xl:href="https://docs.redhat.com/ja/documentation/red_hat_openshift_local/2.43/html/getting_started_guide/introducing"><emphasis role="strong">第1章
Red Hat OpenShift Local の紹介 | Red Hat Product Documentation</emphasis></link></simpara>
<simpara>OpenShift Localは、通常のOpenShift Container Platformよりも軽量になっているため起動時間が比較的早いです。OpenShift Localは、筆者のノートPC上では <emphasis role="strong">約3分で起動</emphasis> します（マシンスペックは後述）。OpenShiftの持ち運びができて、必要なときにサクッと起動できるので、デモや調査目的に気軽に使えてとても便利です。</simpara>
</chapter>
<chapter xml:id="_openshift_container_platformとの違い">
<title>OpenShift Container Platformとの違い</title>
<simpara>OpenShift Localは本番環境では使えませんし、アップグレードもできません。詳細は以下のドキュメントで確認してください。</simpara>
<simpara><link xl:href="https://docs.redhat.com/ja/documentation/red_hat_openshift_local/2.43/html/getting_started_guide/differences_from_a_production_openshift_container_platform_installation"><emphasis role="strong">1.2.
実稼働環境の OpenShift Container Platform インストールとの相違点 |
Red Hat Product Documentation</emphasis></link></simpara>
</chapter>
<chapter xml:id="_openshift_localのインストール">
<title>OpenShift Localのインストール</title>
<simpara>OpenShift Localのインストールはとても簡単です。インストールのための最小システム要件の詳細は、以下のドキュメントを参照してください。</simpara>
<simpara><link xl:href="https://docs.redhat.com/ja/documentation/red_hat_openshift_local/2.43/html/getting_started_guide/installing"><emphasis role="strong">第2章
Red Hat OpenShift Local のインストール | Red Hat Product
Documentation</emphasis></link></simpara>
<section xml:id="_最小システム要件">
<title>最小システム要件</title>
<simpara>CPUは、AMD64、インテル64、Appleシリコンをサポートします。OpenShift Localを動作させるためのハードウェアリソースは以下になります。</simpara>
<itemizedlist>
<listitem>
<simpara>物理 CPU コア 4 個</simpara>
</listitem>
<listitem>
<simpara>空きメモリー 10.5 GB</simpara>
</listitem>
<listitem>
<simpara>ストレージ領域の 35 GB</simpara>
</listitem>
</itemizedlist>
<simpara>OSは、Windows、MacOS、Linuxをサポートします。ただし、Windowsの場合は、
<emphasis role="strong">Microsoft Windows Home Edition ではインストールできません</emphasis>。
ノートPC上への導入を検討されている方は注意してください。</simpara>
</section>
<section xml:id="_筆者のpc環境">
<title>筆者のPC環境</title>
<simpara>参考までに、この記事を書くにあたり使用した筆者のノートPCのスペックは以下になります。</simpara>
<itemizedlist>
<listitem>
<simpara>Fedora Linux 41 (Workstation Edition)</simpara>
</listitem>
<listitem>
<simpara>Lenovo ThinkPad X1 Carbon Gen 11</simpara>
</listitem>
<listitem>
<simpara>Intel Core i7-1370P</simpara>
</listitem>
<listitem>
<simpara>メモリ64GB</simpara>
</listitem>
<listitem>
<simpara>ディスク1TB (外付けSSD)</simpara>
</listitem>
</itemizedlist>
<simpara>ちなみに、筆者はこのノートPCを普段はWindowsマシンとして使っています。Linuxを使いたい場合は、Fedora Linux 41をインストール済みの
<link xl:href="https://www.buffalo.jp/product/detail/ssd-pst1.0u3-ba.html">極小SSD</link>
をUSBの口に指してそこからOSをブートしてLinuxマシンとして使っています。</simpara>
<note>
<simpara>以後のインストール手順は、Fedora 41上で確認済みです。CoreOSやRHELでも同様の手順でインストールできるはずです。</simpara>
</note>
</section>
<section xml:id="_インストール手順">
<title>インストール手順</title>
<orderedlist numeration="arabic">
<listitem>
<simpara>まずインストールに必要なファイルを以下のサイトからダウンロードします。
<link xl:href="https://docs.redhat.com/ja/documentation/red_hat_openshift_local/2.43/html/getting_started_guide/index">https://docs.redhat.com/ja/documentation/red_hat_openshift_local/2.43/html/getting_started_guide/index</link></simpara>
</listitem>
</orderedlist>
<figure>
<title>OpenShift Localインストーラーのダウンロード</title>
<mediaobject>
<imageobject>
<imagedata fileref="./images/chap4_openshift_local_install.png"/>
</imageobject>
<textobject><phrase>chap4 openshift local install</phrase></textobject>
</mediaobject>
</figure>
<itemizedlist>
<listitem>
<simpara><emphasis role="strong">[Download OpenShift Local]</emphasis>
ボタンを押してcrc-linux-amd64.tar.xzという名前のファイルをダウンロードします。</simpara>
</listitem>
<listitem>
<simpara><emphasis role="strong">[Download pull secret]</emphasis> ボタンを押して <emphasis role="strong">pull-secret.txt</emphasis>
という名前のテキストファイルをダウンロードします。</simpara>
</listitem>
</itemizedlist>
<orderedlist numeration="arabic" startingnumber="2">
<listitem>
<simpara>ターミナルを開いて以下のコマンドを実行し、crcコマンドが使えるように準備します。</simpara>
</listitem>
</orderedlist>
<programlisting language="bash" linenumbering="unnumbered">$ cd ~/Downloads
$ tar xvf crc-linux-amd64.tar.xz
$ mkdir -p ~/bin
$ cp ~/Downloads/crc-linux-*-amd64/crc ~/bin
$ export PATH=$PATH:$HOME/bin
$ echo 'export PATH=$PATH:$HOME/bin' &gt;&gt; ~/.bashrc
$ source ~/.bashrc</programlisting>
<simpara>crc versionコマンドを実行して、crcが使えることを確認しましょう。</simpara>
<programlisting language="bash" linenumbering="unnumbered">$ crc version
CRC version: 2.43.0+268795
OpenShift version: 4.17.1
MicroShift version: 4.17.1</programlisting>
<orderedlist numeration="arabic" startingnumber="3">
<listitem>
<simpara><emphasis role="strong">crc setup</emphasis> コマンドを使ってインストールを開始します。インストールの後半で5GB以上のサイズのファイルをネットからダウンロードします。</simpara>
</listitem>
</orderedlist>
<programlisting language="bash" linenumbering="unnumbered">$ crc setup
CRC is constantly improving and we would like to know more about usage (more details at https://developers.redhat.com/article/tool-data-collection)
Your preference can be changed manually if desired using 'crc config set consent-telemetry &lt;yes/no&gt;'
Would you like to contribute anonymous usage statistics? [y/N]: y
Thanks for helping us! You can disable telemetry with the command 'crc config set consent-telemetry no'.
&lt;略&gt;
INFO Downloading bundle: /home/student/.crc/cache/crc_libvirt_4.17.1_amd64.crcbundle...
5.04 GiB / 5.04 GiB [------------------------------------------------------] 100.00% 1.83 MiB/s
INFO Uncompressing /home/student/.crc/cache/crc_libvirt_4.17.1_amd64.crcbundle
crc.qcow2:  18.27 GiB / 18.27 GiB [---------------------------------------------------] 100.00%
oc:  158.70 MiB / 158.70 MiB [--------------------------------------------------------] 100.00%
Your system is correctly setup for using CRC. Use 'crc start' to start the instance</programlisting>
</section>
</chapter>
<chapter xml:id="_crcコマンドの使い方">
<title>crcコマンドの使い方</title>
<simpara><emphasis role="strong">crcコマンド一覧</emphasis><?asciidoc-br?>
OpenShift Localの操作は、crcコマンドを使います。 <emphasis role="strong">crc help</emphasis> コマンドによってcrcコマンドの一覧を表示します。</simpara>
<programlisting language="bash" linenumbering="unnumbered">$ crc help

Available Commands:
bundle      Manage CRC bundles
cleanup     Undo config changes
completion  Generate the autocompletion script for the specified shell
config      Modify crc configuration
console     Open the OpenShift Web Console in the default browser
delete      Delete the instance
help        Help about any command
ip          Get IP address of the running OpenShift cluster
oc-env      Add the 'oc' executable to PATH
podman-env  Setup podman environment
setup       Set up prerequisites for using CRC
start       Start the instance
status      Display status of the OpenShift cluster
stop        Stop the instance
version     Print version information</programlisting>
<section xml:id="_インスタンスの起動">
<title>インスタンスの起動</title>
<simpara><emphasis role="strong">crc start</emphasis> コマンドでOpenShift Localの仮想マシンを起動します。crc
startを実行すると、 <emphasis role="strong">初回だけPull Secretを入力するように促されます</emphasis>
ので、インストールのステップ(1)でダウンロード済みのpull-secret.txtの内容を貼り付けます。</simpara>
<programlisting language="bash" linenumbering="unnumbered">$ crc start
INFO Using bundle path /home/student/.crc/cache/crc_libvirt_4.17.1_amd64.crcbundle
&lt;略&gt;
CRC requires a pull secret to download content from Red Hat.
You can copy it from the Pull Secret section of https://console.redhat.com/openshift/create/local.
? Please enter the pull secret ****************************************************************
INFO Creating CRC VM for OpenShift 4.17.1...</programlisting>
<simpara>crc startコマンドの最後で、以下のように、コンソールのURLとログイン情報が表示されます。これでOpenShiftを利用できる準備が整いました。</simpara>
<programlisting language="bash" linenumbering="unnumbered">Started the OpenShift cluster. +
The server is accessible via web console at: +
https://console-openshift-console.apps-crc.testing/[https://console-openshift-console.apps-crc.testing]

Log in as administrator: +
Username: kubeadmin +
Password: XXXXXXXXX

Log in as user: +
Username: developer +
Password: developer

Use the '`oc`' command line interface: +
$ eval latexmath:[(crc oc-env)] oc login -u developer
https://api.crc.testing:6443/[https://api.crc.testing:6443]</programlisting>
<simpara>OpenShift Localを起動すると、仮想マシンマネージャー上でcrcという名前の仮想マシンが起動していることが確認できます。</simpara>
<figure>
<title>crc仮想マシン (起動)</title>
<mediaobject>
<imageobject>
<imagedata fileref="./images/chap5_crc_start.png"/>
</imageobject>
<textobject><phrase>chap5 crc start</phrase></textobject>
</mediaobject>
</figure>
<simpara><emphasis role="strong">crc status</emphasis> コマンドによって、OpenShift Localのバージョン、メモリ、ディスクの使用状況を調べることができます。</simpara>
<programlisting language="bash" linenumbering="unnumbered">$ crc status
CRC VM:          Running
OpenShift:       Running (v4.17.1)
RAM Usage:       6.218GB of 10.95GB
Disk Usage:      22.01GB of 32.68GB (Inside the CRC VM)
Cache Usage:     25.24GB
Cache Directory: /home/student/.crc/cache</programlisting>
</section>
<section xml:id="_インスタンスの停止">
<title>インスタンスの停止</title>
<simpara><emphasis role="strong">crc stop</emphasis> コマンドでOpenShift Localの仮想マシンを停止します。コマンド実行後、仮想マシンマネージャー上でcrcという名前の仮想マシンが停止していることが確認できます。</simpara>
<programlisting language="bash" linenumbering="unnumbered">$ crc stop
INFO Stopping kubelet and all containers...
INFO Stopping the instance, this may take a few minutes...
Stopped the instance</programlisting>
<figure>
<title>crc仮想マシン (停止)</title>
<mediaobject>
<imageobject>
<imagedata fileref="./images/chap5_crc_stop.png"/>
</imageobject>
<textobject><phrase>chap5 crc stop</phrase></textobject>
</mediaobject>
</figure>
</section>
<section xml:id="_インスタンスの削除">
<title>インスタンスの削除</title>
<simpara>OpenShiftの仮想マシンを削除するには <emphasis role="strong">crc delete</emphasis> を使います。</simpara>
<programlisting language="bash" linenumbering="unnumbered">$ crc delete
Do you want to delete the instance? [y/N]: y
Deleted the instance</programlisting>
<simpara>OpenShift Localを完全にアンインストールするコマンドはありません。 ~/.crc以下には、以下のようにキャッシュされているファイルが存在しています。これらのファイルを手で削除する必要があります。</simpara>
<programlisting language="bash" linenumbering="unnumbered">$ du -h ~/.crc
8.0K    /home/student/.crc/bin/podman
4.0K    /home/student/.crc/bin/oc
17M    /home/student/.crc/bin
19G    /home/student/.crc/cache/crc_libvirt_4.17.1_amd64
24G    /home/student/.crc/cache
24G    /home/student/.crc</programlisting>
</section>
<section xml:id="_インスタンスの設定">
<title>インスタンスの設定</title>
<simpara>OpenShift Localの初期設定では、CPUは4、メモリは10.5G使うように設定されていますが、環境に合わせてこれらを設定変更することができます。</simpara>
<simpara><emphasis role="strong">crc config</emphasis> コマンドで現在のCPU、メモリの設定値の確認ができます。</simpara>
<programlisting language="bash" linenumbering="unnumbered">crc config get cpus
Configuration property 'cpus' is not set. Default value '4' is used

$ crc config get memory
Configuration property 'memory' is not set. Default value '10752' is used</programlisting>
<simpara><emphasis role="strong">crc config set</emphasis> コマンドで現在の設定値の変更ができます。 <emphasis role="strong">crc config view</emphasis> コマンドで、現在の設定値の確認ができます。設定値の変更は次回の起動から反映されます。</simpara>
<programlisting language="bash" linenumbering="unnumbered">$ crc config set cpus 6
Changes to configuration property 'cpus' are only applied when the CRC instance is started.
If you already have a running CRC instance, then for this configuration change to take effect, stop the CRC instance with 'crc stop' and restart it with 'crc start'.

$ crc config set memory 21504
Changes to configuration property 'memory' are only applied when the CRC instance is started.
If you already have a running CRC instance, then for this configuration change to take effect, stop the CRC instance with 'crc stop' and restart it with 'crc start'.

$ crc config view
- consent-telemetry                     : yes
- cpus                                  : 6
- memory                                : 21504</programlisting>
</section>
</chapter>
<chapter xml:id="_webコンソールの使い方">
<title>Webコンソールの使い方</title>
<section xml:id="_webコンソールの起動">
<title>Webコンソールの起動</title>
<simpara><emphasis role="strong">crc console</emphasis> コマンドによって、Webブラウザーが起動し、OpenShift Webコンソールが開きます。</simpara>
<programlisting language="bash" linenumbering="unnumbered">$ crc console
Opening the OpenShift Web Console in the default browser...
既存のブラウザ セッションで開いています。</programlisting>
</section>
<section xml:id="_webコンソールに管理者としてログイン">
<title>Webコンソールに管理者としてログイン</title>
<simpara>管理コンソールにkubeadminというユーザー名でログインしてみましょう。kubadminのパスワードは、oc startコマンドの完了時に表示されたものを使います。</simpara>
<figure>
<title>Webコンソールログイン</title>
<mediaobject>
<imageobject>
<imagedata fileref="./images/chap6_console_login.png"/>
</imageobject>
<textobject><phrase>chap6 console login</phrase></textobject>
</mediaobject>
</figure>
<caution>
<simpara>OpenShift Container Platformインストーラーは、kubeadminという初期管理者アカウントを作成します。OpenShift Localもこの点では同じです。このkubeadminというアカウントはcluster-adminというクラスターの全権限をもったアカウントです。kubeadminは一時的なアカウントです。普通の運用では、インストール後にkubeadminを使って本当の管理者アカウントを作成し、管理作業はそのアカウントで実施するようにします。kubeadminは本当の管理者アカウントを作成したあとは削除します。</simpara>
</caution>
<simpara>ログインが成功するとOpenShiftの管理コンソールが開きます。OpenShift Localではモニタリングの機能が含まれていないので、CPU使用率のようなリソースの使用状況のグラフやアラート機能は使用できません。</simpara>
<figure>
<title>Webコンソールホーム</title>
<mediaobject>
<imageobject>
<imagedata fileref="./images/chap6_console_home.png"/>
</imageobject>
<textobject><phrase>chap6 console home</phrase></textobject>
</mediaobject>
</figure>
<tip>
<simpara>OpenShift Localのモニタリング機能を有効にするには、 $ crc config set enable-cluster-monitoring true を設定します。</simpara>
</tip>
</section>
<section xml:id="_webコンソールに開発者としてログイン">
<title>Webコンソールに開発者としてログイン</title>
<simpara>OpenShift
Localに管理者としてログインするには、developerというユーザー名でログインします。パスワードもdeveloperです。</simpara>
</section>
</chapter>
<chapter xml:id="_cliコマンドの使い方">
<title>CLIコマンドの使い方</title>
<section xml:id="_ocコマンドの準備">
<title>ocコマンドの準備</title>
<simpara><emphasis role="strong">oc</emphasis> コマンドは、OpenShiftクラスターにアクセスするCLIです。<?asciidoc-br?>
OpenShift Localでは、以下のコマンドでocコマンドが使えるようになります</simpara>
<programlisting language="bash" linenumbering="unnumbered">$ crc oc-env
export PATH="/home/student/.crc/bin/oc:$PATH"
# Run this command to configure your shell:
# eval $(crc oc-env)</programlisting>
<simpara>このコマンドがやっていることは、ocコマンド~/.crc/bin/ocを一時的にPATHに通しているだけです。</simpara>
</section>
<section xml:id="_ocコマンドで管理者としてログイン">
<title>ocコマンドで管理者としてログイン</title>
<simpara><emphasis role="strong">oc login</emphasis> コマンドを使ってOpenShiftクラスターにkubeadminでログインします。kubeadminのパスワードはcrc startコマンドのログに出力されます。</simpara>
<tip>
<simpara><emphasis role="strong">crc console –credentials</emphasis> コマンドを使えば、ocコマンドを使ったログイン方法を教えてくれます。<?asciidoc-br?>
$ crc console –credentials<?asciidoc-br?>
To login as a regular user, run <quote>oc login -u developer -p developer
<link xl:href="https://api.crc.testing:6443/">https://api.crc.testing:6443</link></quote>.<?asciidoc-br?>
To login as an admin, run <quote>oc login -u kubeadmin -p XXXXXXXX<?asciidoc-br?>
<link xl:href="https://api.crc.testing:6443/">https://api.crc.testing:6443</link></quote></simpara>
</tip>
</section>
</chapter>
<chapter xml:id="_管理者向け機能確認">
<title>管理者向け機能確認</title>
<simpara>ここはOpenShift Localの内部に興味の管理者の方のみ読んでください。以下のコマンドはkubeadminでログインが必要になります。</simpara>
<section xml:id="_clusterversionを調べる">
<title>Clusterversionを調べる</title>
<simpara><emphasis role="strong">oc get clusterversion</emphasis> コマンドでOpenShiftのバージョンを調べることができます。</simpara>
<programlisting language="bash" linenumbering="unnumbered">$ oc get clusterversion
NAME      VERSION   AVAILABLE   PROGRESSING   SINCE   STATUS
version   4.17.1    True        False         26d     Cluster version is 4.17.1</programlisting>
</section>
<section xml:id="_cluster_operatorを調べる">
<title>Cluster Operatorを調べる</title>
<simpara>OpenShiftの内部サービスは、Cluster Operatorと呼ばれるもので管理されています。 <emphasis role="strong">oc get co</emphasis> コマンドを実行すると、各Operatorのバージョンや状態がわかります。AVAILABLEの列がすべてTrueになっていることを確認します。</simpara>
<programlisting language="bash" linenumbering="unnumbered">$ oc get co
NAME                                       VERSION   AVAILABLE   PROGRESSING   DEGRADED   SINCE   MESSAGE
authentication                             4.17.1    True        False         False      13m
config-operator                            4.17.1    True        False         False      26d
console                                    4.17.1    True        False         False      13m
control-plane-machine-set                  4.17.1    True        False         False      26d
dns                                        4.17.1    True        False         False      13m
etcd                                       4.17.1    True        False         False      26d
image-registry                             4.17.1    True        False         False      32m
ingress                                    4.17.1    True        False         False      26d
kube-apiserver                             4.17.1    True        False         False      26d
kube-controller-manager                    4.17.1    True        False         False      26d
kube-scheduler                             4.17.1    True        False         False      26d
kube-storage-version-migrator              4.17.1    True        False         False      32m
machine-api                                4.17.1    True        False         False      26d
machine-approver                           4.17.1    True        False         False      26d
machine-config                             4.17.1    True        False         False      26d
marketplace                                4.17.1    True        False         False      26d
network                                    4.17.1    True        False         False      26d
openshift-apiserver                        4.17.1    True        False         False      13m
openshift-controller-manager               4.17.1    True        False         False      13m
openshift-samples                          4.17.1    True        False         False      26d
operator-lifecycle-manager                 4.17.1    True        False         False      26d
operator-lifecycle-manager-catalog         4.17.1    True        False         False      26d
operator-lifecycle-manager-packageserver   4.17.1    True        False         False      14m
service-ca                                 4.17.1    True        False         False      26d</programlisting>
</section>
<section xml:id="_nodeの状態を調べる">
<title>Nodeの状態を調べる</title>
<simpara><emphasis role="strong">oc get node</emphasis> コマンドで、OpenShift
Localはシングルノードであること、ステータスがReadyであることを確認します。</simpara>
<programlisting language="bash" linenumbering="unnumbered">$ oc get node
NAME   STATUS   ROLES                         AGE   VERSION
crc    Ready    control-plane,master,worker   26d   v1.30.4</programlisting>
<simpara><emphasis role="strong">oc get adm node-logs</emphasis> コマンドでノードのログを見ることができます。ここではkubeletのログを覗いてみます。</simpara>
<programlisting language="bash" linenumbering="unnumbered">$ oc adm node-logs crc --unit kubelet | tail -5
Nov 16 10:02:39.473751 crc kubenswrapper[4221]: I1116 10:02:39.473438    4221 kubelet_getters.go:218] "Pod status updated" pod="openshift-etcd/etcd-crc" status="Running"
Nov 16 10:02:39.474409 crc kubenswrapper[4221]: I1116 10:02:39.473786    4221 kubelet_getters.go:218] "Pod status updated" pod="openshift-kube-controller-manager/kube-controller-manager-crc" status="Running"
Nov 16 10:02:39.474409 crc kubenswrapper[4221]: I1116 10:02:39.473812    4221 kubelet_getters.go:218] "Pod status updated" pod="openshift-machine-config-operator/kube-rbac-proxy-crio-crc" status="Running"
Nov 16 10:02:39.474409 crc kubenswrapper[4221]: I1116 10:02:39.473849    4221 kubelet_getters.go:218] "Pod status updated" pod="openshift-kube-scheduler/openshift-kube-scheduler-crc" status="Running"
Nov 16 10:02:39.474409 crc kubenswrapper[4221]: I1116 10:02:39.473864    4221 kubelet_getters.go:218] "Pod status updated" pod="openshift-kube-apiserver/kube-apiserver-crc" status="Running"</programlisting>
</section>
<section xml:id="_モニタリングを有効にしてみる">
<title>モニタリングを有効にしてみる</title>
<simpara>crc config
setでモニタリングを有効にすることができます。モニタリングを有効にすることで、メトリックスを収集し、それらの値をもとにグラフ表示をしたりアラートを出したりすることができます。</simpara>
<programlisting language="bash" linenumbering="unnumbered">$ crc config set enable-cluster-monitoring true
Successfully configured enable-cluster-monitoring to true</programlisting>
<figure>
<title>モニタリングダッシュボード</title>
<mediaobject>
<imageobject>
<imagedata fileref="./images/chap8_monitoring_dashboard.png"/>
</imageobject>
<textobject><phrase>chap8 monitoring dashboard</phrase></textobject>
</mediaobject>
</figure>
<simpara><emphasis role="strong">oc adm top node</emphasis> コマンドを使えば、メトリックスから得たリソースの使用状況を表示することができます。</simpara>
<programlisting language="bash" linenumbering="unnumbered">$ oc adm top node
NAME   CPU(cores)   CPU%   MEMORY(bytes)   MEMORY%
crc    869m         14%    10097Mi         49%</programlisting>
<simpara>モニタリングを有効にしてOpenShift Localを再起動してみたところ、起動時間が <emphasis role="strong">10分</emphasis> になりました(モニタリング無効のときは3分)。開発者の方は、モニタリング機能をデフォルトのfalseのままにしておいた方が快適だと思います。</simpara>
</section>
</chapter>
<chapter xml:id="_おわりに">
<title>おわりに</title>
<simpara>OpenShift Localのインストール手順とよく使うコマンドを紹介しました。OpenShift Localは、開発者が使う環境というのが想定されてはいますが、kubeadminのアカウントが用意されているので、管理者がOpenShiftの学習用に使うのにも適していると思います。kubeadminでいろいろ試した結果、クラスターが壊れてしまったとしても、crc delete; crc setupをすればよいので気軽に実験ができますね。</simpara>
</chapter>
</book>